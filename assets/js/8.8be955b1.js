(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{415:function(s,t,a){s.exports=a.p+"assets/img/4.712c6d6e.png"},416:function(s,t,a){s.exports=a.p+"assets/img/1.b31d55d2.png"},417:function(s,t,a){s.exports=a.p+"assets/img/2.dd794dce.png"},418:function(s,t,a){s.exports=a.p+"assets/img/3.0c4b4370.png"},419:function(s,t,a){s.exports=a.p+"assets/img/5.41083087.png"},420:function(s,t,a){s.exports=a.p+"assets/img/6.e559db63.png"},421:function(s,t,a){s.exports=a.p+"assets/img/7.7a80dcb6.png"},422:function(s,t,a){s.exports=a.p+"assets/img/8.6455b294.png"},423:function(s,t,a){s.exports=a.p+"assets/img/11.64d3b55f.png"},424:function(s,t,a){s.exports=a.p+"assets/img/12.fb57a7ae.png"},425:function(s,t,a){s.exports=a.p+"assets/img/10.af2b131b.png"},426:function(s,t,a){s.exports=a.p+"assets/img/14.d9b40593.png"},427:function(s,t,a){s.exports=a.p+"assets/img/13.e3d62491.png"},494:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("编写一个vuepress静态文档项目，并把该项目通过GitHub自动同步到腾讯云的宝塔Linux面板上发布。")])]),s._v(" "),t("p",[s._v("这里我们主要实现的是vuepress项目的部署与同步，关于vuepress项目的实现这里不进行描述")]),s._v(" "),t("h2",{attrs:{id:"服务器购买"}},[s._v("服务器购买")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"腾讯云"}},[s._v("腾讯云")]),s._v(" "),t("p",[s._v("我们可以直接通过百度搜索"),t("code",[s._v("腾讯云")]),s._v("关键字找到"),t("a",{attrs:{href:"https://cloud.tencent.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("腾讯云的官方"),t("OutboundLink")],1),s._v("，然后我们直接注册或者微信扫码登录，然后搜索"),t("code",[s._v("轻量应用服务器")]),s._v("，可以先买够一年（购买前先看是否有优惠）。当然也可以在别的云服务器购买服务，比如：阿里云、华为云等等。这里我是购买的腾讯云服务，所以就以腾讯云为案例。")]),s._v(" "),t("h3",{attrs:{id:"服务器部署"}},[s._v("服务器部署")]),s._v(" "),t("p",[s._v("创建应用的时候选择"),t("code",[s._v("宝塔Linux面板")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(415),alt:""}})]),s._v(" "),t("p",[s._v("在我们购买万云服务器之后，可以点击右上角的"),t("code",[s._v("控制台")]),s._v("进入我们的主页面，然后搜索或点击最近访问列表里的"),t("code",[s._v("轻量应用服务器")]),s._v("。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(416),alt:""}})]),s._v(" "),t("p",[s._v("点击轻量应用服务器，就会进入列表页面，点击"),t("code",[s._v("更多-详情")]),s._v("则会进入到服务器详情页面。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(417),alt:""}})]),s._v(" "),t("p",[s._v("然后需要配置防火墙，点击添加规则分别配置"),t("code",[s._v("8888")]),s._v("和"),t("code",[s._v("3306")]),s._v("端口，否则打不开宝塔面板，后面的操作也会失败。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(418),alt:""}})]),s._v(" "),t("p",[s._v("点击应用管理tab，点击登录，会打开新的登录页面")]),s._v(" "),t("p",[t("img",{attrs:{src:a(419),alt:""}})]),s._v(" "),t("p",[s._v("复制命令"),t("code",[s._v("sudo /etc/init.d/bt default")]),s._v("，到登录页面运行一下就会内外网登录地址和账户与密码：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(420),alt:""}})]),s._v(" "),t("p",[s._v("按着键盘"),t("code",[s._v("ctrl")]),s._v("键，点击外网面板地址，打开新的登录页面，并将上图中的"),t("code",[s._v("username")]),s._v("和"),t("code",[s._v("password")]),s._v("复制粘贴到登录页面输入框中点击登录即可进入宝塔系统；")]),s._v(" "),t("p",[t("img",{attrs:{src:a(421),alt:""}})]),s._v(" "),t("p",[s._v("以上就是关于在腾讯云开通轻量级服务器的步骤，下面的工作就是如何在宝塔面板中进行网站配置和自动化更新。")]),s._v(" "),t("h2",{attrs:{id:"宝塔面板"}},[s._v("宝塔面板")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"配置项目域名"}},[s._v("配置项目域名")]),s._v(" "),t("p",[s._v("登录宝塔面板系统后，首先点击左侧菜单栏的"),t("code",[s._v("网站")]),s._v("菜单，然后按照下图进行配置：")]),s._v(" "),t("p",[t("code",[s._v("选择PHP项目-添加站点")]),s._v("，在弹框面板中填入"),t("code",[s._v("域名")]),s._v("信息，其它项可以使用默认值即可。\n"),t("img",{attrs:{src:a(422),alt:""}})]),s._v(" "),t("h3",{attrs:{id:"上传项目静态资源"}},[s._v("上传项目静态资源")]),s._v(" "),t("p",[s._v("点击左侧菜单栏中的"),t("code",[s._v("文件")]),s._v("菜单，找到刚才新建项目域名的文件夹，点击"),t("code",[s._v("上传")]),s._v("按钮将自己的"),t("code",[s._v("vuepress")]),s._v("项目打包后的静态资源上传即可。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(423),alt:""}})]),s._v(" "),t("p",[s._v("打开浏览器新标签，url栏输入自己项目的域名，如果能正常访问到资源，说明项目初步配置成功；")]),s._v(" "),t("h2",{attrs:{id:"github自动化部署"}},[s._v("GitHub自动化部署")]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("通常我们是将自己的项目源代码托管到远程的Github上面，为了避免每次修改项目内容手动上传更新宝塔静态资源，")]),s._v(" "),t("h3",{attrs:{id:"安装宝塔webhook"}},[s._v("安装宝塔WebHook")]),s._v(" "),t("p",[s._v("点击左侧菜单栏中的"),t("code",[s._v("软件商店")]),s._v("菜单，搜索"),t("code",[s._v("宝塔WebHook")]),s._v("，安装成功后点击添加hook，打开配置面板，名称可以随意填写，主要是执行脚本。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(424),alt:""}})]),s._v(" "),t("p",[s._v("执行脚本示例如下：")]),s._v(" "),t("div",{staticClass:"language-py line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-py"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#输出当前时间")]),s._v("\ndate "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("date"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0 days ago'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+%Y-%m-%d %H:%M:%S"')]),s._v("\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-------开始-------"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#判断宝塔WebHook参数是否存在")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" ! "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$1"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nthen\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param参数错误"')]),s._v("\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"End"')]),s._v("\nexit\nfi\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#服务器 git 项目路径")]),s._v("\ngitPath"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/www/wwwroot/项目目录名称"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#项目 git 网址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#gitHttp="https://github.com/zhangsan/demo.git"')]),s._v("\ngitHttp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/github账户名称/$1.git"')]),s._v("\n\n\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"路径：$gitPath"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#判断项目路径是否存在")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$gitPath"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" then\ncd $gitPath\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#判断是否存在git目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" ! "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".git"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" then\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"在该目录下克隆 git"')]),s._v("\ngit clone $gitHttp gittemp\nmv gittemp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nrm "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rf gittemp\nfi\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拉取最新的项目文件")]),s._v("\ngit reset "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("hard origin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("master\ngit pull\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#git clean -f")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git pull")]),s._v("\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"拉取完成"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#执行npm")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#执行编译")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# npm install")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# npm run build")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置目录权限")]),s._v("\nchown "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("R www"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("www $gitPath\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-------结束--------"')]),s._v("\nexit\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"该项目路径不存在"')]),s._v("\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"End"')]),s._v("\nexit\nfi\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br")])]),t("p",[s._v("其中上面代码中"),t("code",[s._v("$1")]),s._v("参数是从GitHub中的hook配置中带过来的，这里使用的是仓库名称。当然也可以任意定义。")]),s._v(" "),t("h3",{attrs:{id:"github中的配置"}},[s._v("github中的配置")]),s._v(" "),t("p",[s._v("在GitHub项目配置之前，我们需要查看并拷贝一下"),t("code",[s._v("宝塔WebHook")]),s._v("的密匙，点击查看密匙即可拿到密匙。\n"),t("img",{attrs:{src:a(425),alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(426),alt:""}})]),s._v(" "),t("p",[s._v("登录GitHub账号，找到我们需要同步的项目，在Settings面板下有个Webhooks功能，我们可以在这里进行配置。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(427),alt:""}})]),s._v(" "),t("p",[s._v("其中"),t("code",[s._v("Payload URL")]),s._v("项填入宝塔webhook中的回调地址，即：")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("POST")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("http")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("你项目的回调地址"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("hook"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("access_key"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("你的密匙"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("param"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("你的仓库名称即上面的那个$1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("code",[s._v("Content type")]),s._v("我们现在使用Json格式传输")]),s._v(" "),t("p",[t("code",[s._v("Which events would you like to trigger this webhook?")]),s._v("即触发钩子函数回调的方式，那些事件可以触发同步，可以根据自己的情况配置。")]),s._v(" "),t("p",[s._v("点击创建完成，即可触发一次回调，稍微等几分钟去宝塔面板的"),t("code",[s._v("宝塔WebHook")]),s._v("中，点击日志查看是否成功。也可以去文件夹目录看一下文件的更新时间是否为最新时间，如果是则表示自动同步成功。")]),s._v(" "),t("hr"),s._v(" "),t("p",[t("strong",[s._v("如果看完觉得有收获，欢迎点赞、评论、分享支持一下。你的支持和肯定，是我坚持写作的动力~")])]),s._v(" "),t("p",[s._v("最后可以关注我@零度杂谈。欢迎"),t("a",{attrs:{href:"https://holazero.cn/wx_code.jpg",target:"_blank",rel:"noopener noreferrer"}},[s._v("点此扫码关注"),t("OutboundLink")],1),s._v("交流，共同进步~")])])}),[],!1,null,null,null);t.default=e.exports}}]);